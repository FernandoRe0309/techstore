<%- include('partials/header') %>

<h1>Nuestros Productos</h1>

<div class="product-grid">
    <% products.forEach(product => { %>
        <div class="card">
            <img src="<%= product.image %>" alt="<%= product.name %>">
            <h3><%= product.name %></h3>
            <p class="price">$<%= product.price %></p>
            <p><%= product.description %></p>
            <button onclick="addToCart('<%= product.id %>', '<%= product.name %>', '<%= product.price %>', '<%= product.image %>')">
                Agregar al Carrito
            </button>
        </div>
    <% }) %>
</div>

<script>
function addToCart(id, name, price, image) {
    fetch('/api/cart/add', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ id, name, price, image })
    })
    .then(res => res.json())
    .then(data => {
        if(data.success) {
            alert('Â¡Producto agregado!');
            location.reload(); // Recarga para actualizar el contador del nav
        }
    })
    .catch(err => console.error(err));
}
</script>

<%- include('partials/footer') %>